<!DOCTYPE html>
<!--[if IE 6]>
<html id="ie6" dir="ltr" lang="en-US">
<![endif]-->
<!--[if IE 7]>
<html id="ie7" dir="ltr" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html id="ie8" dir="ltr" lang="en-US">
<![endif]-->
<!--[if !(IE 6) | !(IE 7) | !(IE 8)  ]><!-->
<html dir="ltr" lang="en-US"><!--<![endif]--><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<title>Custom Wordpress Plugin Activation Error Messages | Square Penguin</title>
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="stylesheet" type="text/css" media="all" href="Custom%20Wordpress%20Plugin%20Activation%20Error%20Messages%20%7C%20Square%20Penguin_files/style.css">
<link rel="pingback" href="http://www.squarepenguin.com/wordpress/xmlrpc.php">
<!--[if lt IE 9]>
<script src="http://www.squarepenguin.com/wordpress/wp-content/themes/twentyeleven/js/html5.js" type="text/javascript"></script>
<![endif]-->
<link rel="alternate" type="application/rss+xml" title="Square Penguin » Feed" href="http://www.squarepenguin.com/wordpress/?feed=rss2">
<link rel="alternate" type="application/rss+xml" title="Square Penguin » Comments Feed" href="http://www.squarepenguin.com/wordpress/?feed=comments-rss2">
<link rel="alternate" type="application/rss+xml" title="Square Penguin » Custom WordPress Plugin Activation Error Messages Comments Feed" href="http://www.squarepenguin.com/wordpress/?feed=rss2&amp;p=6">
<script type="text/javascript" async="" src="Custom%20Wordpress%20Plugin%20Activation%20Error%20Messages%20%7C%20Square%20Penguin_files/quant.js"></script><script type="text/javascript" src="Custom%20Wordpress%20Plugin%20Activation%20Error%20Messages%20%7C%20Square%20Penguin_files/comment-reply.js"></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.squarepenguin.com/wordpress/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.squarepenguin.com/wordpress/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="Enabling WordPress SFTP (SSH) Updates" href="http://www.squarepenguin.com/wordpress/?p=38">
<link rel="next" title="Extending Switch Controlled Outlets to Other Outlets in the Room" href="http://www.squarepenguin.com/wordpress/?p=42">
<meta name="generator" content="WordPress 3.4">
<link rel="canonical" href="http://www.squarepenguin.com/wordpress/?p=6">
<link rel="shortlink" href="http://wp.me/p1EzJ8-6">

<link rel="stylesheet" href="Custom%20Wordpress%20Plugin%20Activation%20Error%20Messages%20%7C%20Square%20Penguin_files/wp-syntax.css" type="text/css" media="screen">
<link rel="stylesheet" type="text/css" id="gravatar-card-css" href="Custom%20Wordpress%20Plugin%20Activation%20Error%20Messages%20%7C%20Square%20Penguin_files/hovercard.css"><link rel="stylesheet" type="text/css" id="gravatar-card-services-css" href="Custom%20Wordpress%20Plugin%20Activation%20Error%20Messages%20%7C%20Square%20Penguin_files/services.css"></head>

<body class="single single-post postid-6 single-format-standard single-author singular two-column right-sidebar">
<div id="page" class="hfeed">
	<header id="branding" role="banner">
			<hgroup>
				<h1 id="site-title"><span><a href="http://www.squarepenguin.com/wordpress/" title="Square Penguin" rel="home">Square Penguin</a></span></h1>
				<h2 id="site-description">Random Hacks &amp; Projects</h2>
			</hgroup>

						<a href="http://www.squarepenguin.com/wordpress/">
									<img src="Custom%20Wordpress%20Plugin%20Activation%20Error%20Messages%20%7C%20Square%20Penguin_files/cropped-Screen-shot-2011-12-17-at-1.jpg" alt="" height="288" width="1000">
							</a>
			
								<form method="get" id="searchform" action="http://www.squarepenguin.com/wordpress/">
		<label for="s" class="assistive-text">Search</label>
		<input class="field" name="s" id="s" placeholder="Search" type="text">
		<input class="submit" name="submit" id="searchsubmit" value="Search" type="submit">
	</form>
			
			<nav id="access" role="navigation">
				<h3 class="assistive-text">Main menu</h3>
								<div class="skip-link"><a class="assistive-text" href="#content" title="Skip to primary content">Skip to primary content</a></div>
				<div class="skip-link"><a class="assistive-text" href="#secondary" title="Skip to secondary content">Skip to secondary content</a></div>
								<div class="menu"><ul><li><a href="http://www.squarepenguin.com/wordpress/" title="Home">Home</a></li><li class="page_item page-item-249"><a href="http://www.squarepenguin.com/wordpress/?page_id=249">Products Page</a><ul class="children"><li class="page_item page-item-250"><a href="http://www.squarepenguin.com/wordpress/?page_id=250">Checkout</a></li><li class="page_item page-item-251"><a href="http://www.squarepenguin.com/wordpress/?page_id=251">Transaction Results</a></li><li class="page_item page-item-252"><a href="http://www.squarepenguin.com/wordpress/?page_id=252">Your Account</a></li></ul></li></ul></div>
			</nav><!-- #access -->
	</header><!-- #branding -->


	<div id="main">
		<div id="primary">
			<div id="content" role="main">

				
					<nav id="nav-single">
						<h3 class="assistive-text">Post navigation</h3>
						<span class="nav-previous"><a href="http://www.squarepenguin.com/wordpress/?p=38" rel="prev"><span class="meta-nav">←</span> Previous</a></span>
						<span class="nav-next"><a href="http://www.squarepenguin.com/wordpress/?p=42" rel="next">Next <span class="meta-nav">→</span></a></span>
					</nav><!-- #nav-single -->

					
<article id="post-6" class="post-6 post type-post status-publish format-standard hentry category-wordpress-plugins">
	<header class="entry-header">
		<h1 class="entry-title">Custom WordPress Plugin Activation Error Messages</h1>

				<div class="entry-meta">
			<span class="sep">Posted on </span><a href="http://www.squarepenguin.com/wordpress/?p=6" title="6:42 pm" rel="bookmark"><time class="entry-date" datetime="2011-06-23T18:42:09+00:00" pubdate="">June 23, 2011</time></a><span class="by-author"> <span class="sep"> by </span> <span class="author vcard"><a class="url fn n" href="http://www.squarepenguin.com/wordpress/?author=1" title="View all posts by jason" rel="author">jason</a></span></span>		</div><!-- .entry-meta -->
			</header><!-- .entry-header -->

	<div class="entry-content">
		<p>One of the goals of being a WordPress Plugin developer is to reduce
 the amount of support needed by people using your plugin. One way to 
make your life easier is to display easy to understand error messages 
when something about their setup is preventing your plugin from working 
correctly. One way to do this is to check for compatibility during the 
plugin activation. Unfortunately, by default when WordPress fails to 
activate your plugin only cryptic or unhelpful messages are typically 
displayed. I will introduce a quick and easy way around this.</p>
<p>To add code that runs during activation you simply add the following line to your plugin:</p>

<div class="wp_syntax"><div class="code"><pre class="java" style="font-family:monospace;">register_activation_hook<span style="color: #009900;">(</span>__FILE__,<span style="color: #0000ff;">'your_activation_function'</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span></pre></div></div>

<p>where your_activation_function is the name of some function in your code that handles your plugin activation.</p>
<p>&nbsp;</p>
<p>By default WordPress will display one of two error messages if your plugin fails to activate:</p>
<p>&nbsp;</p>
<ol>
<li><strong>The plugin generated %d characters of unexpected output during activation. </strong>You
 will see this is you have any text outside of the &lt;?php ?&gt; tags 
in your plugin’s php files, or try to output any information during the 
activation process. You cannot simply output error messages during 
activation, because WordPress will not show them.</li>
<li><strong>Plugin could not be activated because it triggered a fatal error.</strong>
 If your plugin triggers an error during the activation, this message is
 shown in addition to the php output error message. If you have a custom
 error handler setup on your server then this detailed error information
 may appear elsewhere.</li>
</ol>
<p>Neither of these error messages are very helpful; fortunately, this 
behavior can be modified.&nbsp; When WordPress activates plugins it 
first validates the header information of the plugin, and then it loads 
the plugin and runs the activation hook. If it detects any errors or 
output it decides the plugin is broken. It then opens up an iFrame where
 it runs the plugin activate hook a second time. When it does this 
WordPress adds a url parameter so we can know where in the activation 
process we are. So, instead of using the built in trigger_error function
 you can define your own that modifies the behavior according to the 
whether or not the action=error_scrape parameter is present.</p>
<p>Instead of</p>

<div class="wp_syntax"><div class="code"><pre class="php" style="font-family:monospace;"><span style="color: #990000;">trigger_error</span><span style="color: #009900;">(</span><span style="color: #0000ff;">'Some error message'</span><span style="color: #339933;">,</span> <span style="color: #009900; font-weight: bold;">E_USER_ERROR</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span></pre></div></div>

<p><img class="aligncenter size-full wp-image-19" title="nice_error" src="Custom%20Wordpress%20Plugin%20Activation%20Error%20Messages%20%7C%20Square%20Penguin_files/default_error.png" alt="" height="153" width="614"></p>
<p>Use</p>

<div class="wp_syntax"><div class="code"><pre class="php" style="font-family:monospace;">br_trigger_error<span style="color: #009900;">(</span><span style="color: #0000ff;">'Some error message'</span><span style="color: #339933;">,</span> <span style="color: #009900; font-weight: bold;">E_USER_ERROR</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #000000; font-weight: bold;">function</span> br_trigger_error<span style="color: #009900;">(</span><span style="color: #000088;">$message</span><span style="color: #339933;">,</span> <span style="color: #000088;">$errno</span><span style="color: #009900;">)</span> <span style="color: #009900;">{</span>
&nbsp;
    <span style="color: #b1b100;">if</span><span style="color: #009900;">(</span><span style="color: #990000;">isset</span><span style="color: #009900;">(</span><span style="color: #000088;">$_GET</span><span style="color: #009900;">[</span><span style="color: #0000ff;">'action'</span><span style="color: #009900;">]</span><span style="color: #009900;">)</span>
          <span style="color: #339933;">&amp;</span>amp<span style="color: #339933;">;&amp;</span>amp<span style="color: #339933;">;</span> <span style="color: #000088;">$_GET</span><span style="color: #009900;">[</span><span style="color: #0000ff;">'action'</span><span style="color: #009900;">]</span> <span style="color: #339933;">==</span> <span style="color: #0000ff;">'error_scrape'</span><span style="color: #009900;">)</span> <span style="color: #009900;">{</span>
&nbsp;
        <span style="color: #b1b100;">echo</span> <span style="color: #0000ff;">'&lt;strong&gt;'</span> <span style="color: #339933;">.</span> <span style="color: #000088;">$message</span> <span style="color: #339933;">.</span> <span style="color: #0000ff;">'&lt;/strong&gt;'</span><span style="color: #339933;">;</span>
&nbsp;
        <span style="color: #990000;">exit</span><span style="color: #339933;">;</span>
&nbsp;
    <span style="color: #009900;">}</span> <span style="color: #b1b100;">else</span> <span style="color: #009900;">{</span>
&nbsp;
        <span style="color: #990000;">trigger_error</span><span style="color: #009900;">(</span><span style="color: #000088;">$message</span><span style="color: #339933;">,</span> <span style="color: #000088;">$errno</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
&nbsp;
    <span style="color: #009900;">}</span>
&nbsp;
<span style="color: #009900;">}</span></pre></div></div>

<p><img class="aligncenter size-full wp-image-19" title="nice_error" src="Custom%20Wordpress%20Plugin%20Activation%20Error%20Messages%20%7C%20Square%20Penguin_files/nice_error.png" alt="" height="153" width="614"></p>
<p>Your users will now be presented with information that they will be able to understand.</p>
<p>As an example, one of my plugins uses file_get_contents to retrieve 
information from a url, which requires that allow_url_fopen is allowed. 
In the activation function I have:</p>

<div class="wp_syntax"><div class="code"><pre class="php" style="font-family:monospace;">  <span style="color: #b1b100;">if</span><span style="color: #009900;">(</span><span style="color: #339933;">!</span><span style="color: #990000;">ini_set</span><span style="color: #009900;">(</span><span style="color: #0000ff;">'allow_url_fopen'</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span> <span style="color: #009900;">{</span>
    br_trigger_error<span style="color: #009900;">(</span><span style="color: #0000ff;">'Your server does not allow \'allow_url_fopen.\' Please contact your webmaster and ask them to enable this setting.'</span><span style="color: #009900;">)</span><span style="color: #339933;">;</span>
  <span style="color: #009900;">}</span></pre></div></div>

			</div><!-- .entry-content -->

	<footer class="entry-meta">
		This entry was posted in <a href="http://www.squarepenguin.com/wordpress/?cat=3" title="View all posts in Wordpress Plugins" rel="category">Wordpress Plugins</a> by <a href="http://www.squarepenguin.com/wordpress/?author=1">jason</a>. Bookmark the <a href="http://www.squarepenguin.com/wordpress/?p=6" title="Permalink to Custom WordPress Plugin Activation Error Messages" rel="bookmark">permalink</a>.		
			</footer><!-- .entry-meta -->
</article><!-- #post-6 -->

						<div id="comments">
	
	
			<h2 id="comments-title">
			4 thoughts on “<span>Custom WordPress Plugin Activation Error Messages</span>”		</h2>

		
		<ol class="commentlist">
				<li class="comment even thread-even depth-1" id="li-comment-1910">
		<article id="comment-1910" class="comment">
			<footer class="comment-meta">
				<div class="comment-author vcard">
					<img id="grav-e728ec5635ba55ca084dcf0dcc1a1c1a-0" alt="" src="Custom%20Wordpress%20Plugin%20Activation%20Error%20Messages%20%7C%20Square%20Penguin_files/e728ec5635ba55ca084dcf0dcc1a1c1a.png" class="avatar avatar-68 photo grav-hashed grav-hijack" height="68" width="68"><span class="fn">Andrew</span> on <a href="http://www.squarepenguin.com/wordpress/?p=6#comment-1910"><time pubdate="" datetime="2012-04-03T15:15:54+00:00">April 3, 2012 at 3:15 pm</time></a> <span class="says">said:</span>
									</div><!-- .comment-author .vcard -->

				
			</footer>

			<div class="comment-content"><p>Thank you for posting this!<br>
However, I would like to use this code. It seems almost too simple to even copyright, but I would like to play it safe.<br>
What license is this code released under?<br>
If it’s too restrictive, I’ll have to seek an alternative source.</p>
<p>Thanks</p>
</div>

			<div class="reply">
				<a class="comment-reply-link" href="http://www.squarepenguin.com/wordpress/?p=6&amp;replytocom=1910#respond" onclick='return addComment.moveForm("comment-1910", "1910", "respond", "6")'>Reply <span>↓</span></a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	<ul class="children">
	<li class="comment byuser comment-author-jason bypostauthor odd alt depth-2" id="li-comment-1915">
		<article id="comment-1915" class="comment">
			<footer class="comment-meta">
				<div class="comment-author vcard">
					<img id="grav-bea76a66729fc6e9968413be383655f3-0" alt="" src="Custom%20Wordpress%20Plugin%20Activation%20Error%20Messages%20%7C%20Square%20Penguin_files/bea76a66729fc6e9968413be383655f3.png" class="avatar avatar-39 photo grav-hashed grav-hijack" height="39" width="39"><span class="fn">jason</span> on <a href="http://www.squarepenguin.com/wordpress/?p=6#comment-1915"><time pubdate="" datetime="2012-04-03T20:35:06+00:00">April 3, 2012 at 8:35 pm</time></a> <span class="says">said:</span>
									</div><!-- .comment-author .vcard -->

				
			</footer>

			<div class="comment-content"><p>Andrew,</p>
<p>  There are no restrictions on how or where this method or ‘trick’ can be used.</p>
</div>

			<div class="reply">
				<a class="comment-reply-link" href="http://www.squarepenguin.com/wordpress/?p=6&amp;replytocom=1915#respond" onclick='return addComment.moveForm("comment-1915", "1915", "respond", "6")'>Reply <span>↓</span></a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li>
</ul>
</li>
	<li class="comment byuser comment-author-jason bypostauthor even thread-odd thread-alt depth-1" id="li-comment-2188">
		<article id="comment-2188" class="comment">
			<footer class="comment-meta">
				<div class="comment-author vcard">
					<img id="grav-bea76a66729fc6e9968413be383655f3-1" alt="" src="Custom%20Wordpress%20Plugin%20Activation%20Error%20Messages%20%7C%20Square%20Penguin_files/bea76a66729fc6e9968413be383655f3_002.png" class="avatar avatar-68 photo grav-hashed grav-hijack" height="68" width="68"><span class="fn">jason</span> on <a href="http://www.squarepenguin.com/wordpress/?p=6#comment-2188"><time pubdate="" datetime="2012-04-20T17:34:31+00:00">April 20, 2012 at 5:34 pm</time></a> <span class="says">said:</span>
									</div><!-- .comment-author .vcard -->

				
			</footer>

			<div class="comment-content"><p>Instead of all of this, you could 
simply use die(‘Your error message here’) and avoid the extra 
complication. On the second plugin load, where WordPress scrapes for the
 error message, you could still search for error_scrape and not 
duplicate the failed plugin activation and print out the error message 
directly.</p>
</div>

			<div class="reply">
				<a class="comment-reply-link" href="http://www.squarepenguin.com/wordpress/?p=6&amp;replytocom=2188#respond" onclick='return addComment.moveForm("comment-2188", "2188", "respond", "6")'>Reply <span>↓</span></a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li>
	<li class="comment odd alt thread-even depth-1" id="li-comment-3483">
		<article id="comment-3483" class="comment">
			<footer class="comment-meta">
				<div class="comment-author vcard">
					<img id="grav-4b436130243820b49be31a84f6b71a1f-0" alt="" src="Custom%20Wordpress%20Plugin%20Activation%20Error%20Messages%20%7C%20Square%20Penguin_files/4b436130243820b49be31a84f6b71a1f.png" class="avatar avatar-68 photo grav-hashed grav-hijack" height="68" width="68"><span class="fn">Federico</span> on <a href="http://www.squarepenguin.com/wordpress/?p=6#comment-3483"><time pubdate="" datetime="2012-06-26T09:16:13+00:00">June 26, 2012 at 9:16 am</time></a> <span class="says">said:</span>
									</div><!-- .comment-author .vcard -->

				
			</footer>

			<div class="comment-content"><p>Tank you, this is useful for me.<br>
But what if I want to output a notice, and not a fatal error?</p>
</div>

			<div class="reply">
				<a class="comment-reply-link" href="http://www.squarepenguin.com/wordpress/?p=6&amp;replytocom=3483#respond" onclick='return addComment.moveForm("comment-3483", "3483", "respond", "6")'>Reply <span>↓</span></a>			</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li>
		</ol>

		
	
									<div id="respond">
				<h3 id="reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://www.squarepenguin.com/wordpress/?p=6#respond" style="display: none;">Cancel reply</a></small></h3>
									<form action="http://www.squarepenguin.com/wordpress/wp-comments-post.php" method="post" id="commentform">
																			<p class="comment-notes">Your email address will not be published. Required fields are marked <span class="required">*</span></p>							<p class="comment-form-author"><label for="author">Name</label> <span class="required">*</span><input id="author" name="author" size="30" aria-required="true" type="text"></p>
<p class="comment-form-email"><label for="email">Email</label> <span class="required">*</span><input id="email" name="email" size="30" aria-required="true" type="text"></p>
<p class="comment-form-url"><label for="url">Website</label><input id="url" name="url" size="30" type="text"></p>
												<p class="comment-form-comment"><label for="comment">Comment</label><textarea id="comment" name="comment" cols="45" rows="8" aria-required="true"></textarea></p>						<p class="form-allowed-tags">You may use these <abbr title="HyperText Markup Language">HTML</abbr> tags and attributes:  <code>&lt;a
 href="" title=""&gt; &lt;abbr title=""&gt; &lt;acronym title=""&gt; 
&lt;b&gt; &lt;blockquote cite=""&gt; &lt;cite&gt; &lt;code&gt; &lt;del 
datetime=""&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=""&gt; &lt;strike&gt; 
&lt;strong&gt; &lt;pre lang="" line="" escaped="" highlight=""&gt; </code></p>						<p class="form-submit">
							<input name="submit" id="submit" value="Post Comment" type="submit">
							<input name="comment_post_ID" value="6" id="comment_post_ID" type="hidden">
<input name="comment_parent" id="comment_parent" value="0" type="hidden">
						</p>
						<p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" value="203761afb3" type="hidden"></p><p class="comment-subscription-form"><input name="subscribe_comments" id="subscribe_comments" value="subscribe" style="width: auto; -moz-appearance: checkbox;" type="checkbox"> <label class="subscribe-label" id="subscribe-label" for="subscribe_comments">Notify me of follow-up comments by email.</label></p><p class="comment-subscription-form"><input name="subscribe_blog" id="subscribe_blog" value="subscribe" style="width: auto; -moz-appearance: checkbox;" type="checkbox"> <label class="subscribe-label" id="subscribe-blog-label" for="subscribe_blog">Notify me of new posts by email.</label></p>					</form>
							</div><!-- #respond -->
						
</div><!-- #comments -->

				
			</div><!-- #content -->
		</div><!-- #primary -->


	</div><!-- #main -->

	<footer id="colophon" role="contentinfo">

			

			<div id="site-generator">
								<a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">Proudly powered by WordPress</a>
			</div>
	</footer><!-- #colophon -->
</div><!-- #page -->

<script type="text/javascript" src="Custom%20Wordpress%20Plugin%20Activation%20Error%20Messages%20%7C%20Square%20Penguin_files/jquery.js"></script>
<script type="text/javascript" src="Custom%20Wordpress%20Plugin%20Activation%20Error%20Messages%20%7C%20Square%20Penguin_files/gprofiles.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type="text/javascript" src="Custom%20Wordpress%20Plugin%20Activation%20Error%20Messages%20%7C%20Square%20Penguin_files/wpgroho.js"></script>
	<div style="display:none">
	<div class="grofile-hash-map-e728ec5635ba55ca084dcf0dcc1a1c1a">
	</div>
	<div class="grofile-hash-map-bea76a66729fc6e9968413be383655f3">
	</div>
	<div class="grofile-hash-map-4b436130243820b49be31a84f6b71a1f">
	</div>
	</div>

	<script src="Custom%20Wordpress%20Plugin%20Activation%20Error%20Messages%20%7C%20Square%20Penguin_files/e-201228.js" type="text/javascript"></script>
	<script type="text/javascript">
	st_go({v:'ext',j:'1:1.4.2',blog:'24446794',post:'6'});
	var load_cmc = function(){linktracker_init(24446794,6,2);};
	if ( typeof addLoadEvent != 'undefined' ) addLoadEvent(load_cmc);
	else load_cmc();
	</script><img id="wpstats" src="Custom%20Wordpress%20Plugin%20Activation%20Error%20Messages%20%7C%20Square%20Penguin_files/g.gif" alt="">

</body></html>